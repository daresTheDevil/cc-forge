#!/usr/bin/env bash
# cc-forge â€” CC-Forge global bootstrapper
#
# Usage:
#   npx cc-forge              Install cc-forge globally + deploy global files
#   npx cc-forge@latest       Update to latest version
#
# This command does two things:
#   1. Installs cc-forge globally via npm (makes `forge` permanently available)
#   2. Runs `forge setup` to deploy global files to ~/.claude/

set -euo pipefail

PACKAGE_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
VERSION="$(node -p "require('${PACKAGE_DIR}/package.json').version")"

printf '[CC-Forge] Installing cc-forge v%s globally...\n' "$VERSION"
npm install -g "cc-forge@${VERSION}"

printf '[CC-Forge] Deploying global files...\n'
forge setup

printf '\n[CC-Forge] Done. Commands available:\n'
printf '  forge init      Bootstrap a project\n'
printf '  forge update    Update to latest version\n'
printf '  forge version   Show installed version\n'
